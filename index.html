<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Twitter Broadcast by serenity</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Twitter Broadcast</h1>
        <p class="header">Node.js + Twitter Streaming API + Websockets = &lt;3</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/serenity/twtcst/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/serenity/twtcst/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/serenity/twtcst">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/serenity">serenity</a></p>


      </header>
      <section>
        <p>It’s a nodejs module provide you easy interface to get the stream of tweets.</p>

<p><a href="http://simonenko.su/53381781858/pulse-of-web-developments">Article about this in Russian in my blog.</a></p>

<div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">twtcst</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'twtcst'</span><span class="p">);</span>

<span class="c1">// array of words you want to track</span>
<span class="kd">var</span> <span class="nx">words</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'javascript'</span><span class="p">,</span> <span class="s1">'coffeescript'</span><span class="p">];</span>

<span class="c1">// object contains your oauth tokens</span>
<span class="kd">var</span> <span class="nx">oauth</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'consumer_key'</span><span class="o">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="s1">'consumer_secret'</span><span class="o">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="s1">'token'</span><span class="o">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="s1">'token_secret'</span><span class="o">:</span> <span class="s1">''</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">twitter</span> <span class="o">=</span> <span class="nx">twtcst</span><span class="p">(</span><span class="nx">words</span><span class="p">,</span> <span class="nx">oauth</span><span class="p">);</span>

<span class="c1">// twitter stream api</span>
<span class="nx">twitter</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">tweet</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">tweet</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="install-with-npm" class="anchor" href="#install-with-npm"><span class="octicon octicon-link"></span></a>Install with NPM</h2>

<div class="highlight highlight-bash"><pre>npm install twtcst
</pre></div>

<h2>
<a name="api" class="anchor" href="#api"><span class="octicon octicon-link"></span></a>API</h2>

<p><code>twtcst</code> has three parameters. The first is <code>words</code> you want to search, the second is your <code>oauth</code> tokens, and the third (optional) is <code>options</code> to define some filters, counters and views.</p>

<div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">twitter</span> <span class="o">=</span> <span class="nx">twtcst</span><span class="p">(</span><span class="nx">words</span><span class="p">,</span> <span class="nx">oauth</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</pre></div>

<p>The <code>twitter</code> object has two methods: <code>search</code> and <code>filter</code>.</p>

<p><strong>search</strong> implement <a href="http://dev.twitter.com/docs/api/1.1/get/search/tweets">Twitter Search API</a>. It takes a callback as an argument. The callback will be caused when all tweets are found. The first argument of callback is error (if it has occured) and the second is array of tweets.</p>

<div class="highlight highlight-js"><pre><span class="nx">twitter</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">tweets</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">tweets</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">tweets</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">tweet</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">message</span><span class="p">(</span><span class="nx">tweet</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p><strong>filter</strong> implement <a href="http://dev.twitter.com/docs/api/1.1/post/statuses/filter">Twitter Streaming API</a>. It cause callback and passed new tweet to it every time new tweet appears in Twitter Stream. The filter pass to callback two options: <code>error</code> and <code>tweet</code>.</p>

<div class="highlight highlight-js"><pre><span class="nx">twitter</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">tweet</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">tweet</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">message</span><span class="p">(</span><span class="nx">tweet</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p><strong>Format of tweets</strong> is similar in both cases:</p>

<div class="highlight highlight-js"><pre><span class="p">{</span>
  <span class="nx">id</span><span class="o">:</span> <span class="s2">"Tweet id"</span>
  <span class="nx">link</span><span class="o">:</span> <span class="s2">"Link to user page on Twitter"</span>
  <span class="nx">avatar</span><span class="o">:</span> <span class="s2">"Link to user profile image"</span>
  <span class="nx">login</span><span class="o">:</span> <span class="s2">"User login (@username without @)"</span>
  <span class="nx">name</span><span class="o">:</span> <span class="s2">"User name or login"</span>
  <span class="nx">text</span><span class="o">:</span> <span class="s2">"Improved text of the tweet"</span>
  <span class="nx">date</span><span class="o">:</span> <span class="s2">"YYYY-MM-DD HH:MM"</span>
  <span class="nx">iso</span><span class="o">:</span> <span class="s2">"Date in ISO"</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="words" class="anchor" href="#words"><span class="octicon octicon-link"></span></a>Words</h3>

<p><code>words</code> is array contains words you want to search. It also can contains hashtags started with hash, e.g.:</p>

<div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">words</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s2">"#javascript"</span><span class="p">,</span>
  <span class="s2">"#coffeescript"</span>
<span class="p">];</span>
</pre></div>

<h3>
<a name="oauth-tokens" class="anchor" href="#oauth-tokens"><span class="octicon octicon-link"></span></a>OAuth tokens</h3>

<p><code>oauth</code> is an object in format required by Twitter API. You can get tokens by <a href="http://dev.twitter.com/apps/new">creating new app</a> or <a href="http://dev.twitter.com/apps">from existing app</a>.</p>

<div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">oauth</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'consumer_key'</span><span class="o">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="s1">'consumer_secret'</span><span class="o">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="s1">'token'</span><span class="o">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="s1">'token_secret'</span><span class="o">:</span> <span class="s1">''</span>
<span class="p">};</span>
</pre></div>

<h3>
<a name="options" class="anchor" href="#options"><span class="octicon octicon-link"></span></a>Options</h3>

<p>All options are optional.</p>

<p><strong>version</strong> is <code>string</code> of Twitter Stream API version (1.1 by default)</p>

<div class="highlight highlight-js"><pre><span class="s2">"version"</span><span class="o">:</span> <span class="s2">"1.1"</span>
</pre></div>

<p><strong>lang</strong> is <code>array</code> of languages. If the language of tweet is not in the array, the tweet won’t be displayed.</p>

<div class="highlight highlight-js"><pre><span class="s2">"lang"</span><span class="o">:</span> <span class="p">[</span><span class="s2">"en"</span><span class="p">,</span> <span class="s2">"ru"</span><span class="p">]</span>
</pre></div>

<p><strong>spam</strong> is <code>array</code> of strings. Tweets contain one of the strings won’t be displayed.</p>

<div class="highlight highlight-js"><pre><span class="s2">"spam"</span><span class="o">:</span> <span class="p">[</span>
  <span class="s1">'text/javascript'</span><span class="p">,</span>
  <span class="s1">'jquery'</span>
<span class="p">]</span>
</pre></div>

<p><strong>mute</strong> is <code>array</code> of usernames. Tweets writen by people specified in this array won’t be displayed.</p>

<div class="highlight highlight-js"><pre><span class="s2">"mute"</span><span class="o">:</span> <span class="p">[</span>
  <span class="s2">"simonenko"</span><span class="p">,</span>
  <span class="s2">"isquariel"</span>
<span class="p">]</span>
</pre></div>

<p><strong>retweets</strong> is <code>boolean</code>. If it is <code>false</code> retweets won’t be displayed. The variable is <code>false</code> by default.</p>

<div class="highlight highlight-js"><pre><span class="s2">"retweets"</span><span class="o">:</span> <span class="kc">false</span>
</pre></div>

<p><strong>mentions</strong> work as <strong>retweets</strong>. If it is <code>false</code> mentions won’t be displayed.</p>

<div class="highlight highlight-js"><pre><span class="s2">"mentions"</span><span class="o">:</span> <span class="kc">false</span>
</pre></div>

<p><strong>userpics</strong> is <code>boolean</code>. If it is <code>true</code> tweet posted by users with default avatar won’t be displayed.</p>

<div class="highlight highlight-js"><pre><span class="s2">"userpics"</span><span class="o">:</span> <span class="kc">true</span>
</pre></div>

<p><strong>hashtags</strong> is <code>number</code> defining max quantity of hashtags in tweets. Tweets contains more hashtags than specified won’t be displayed.</p>

<div class="highlight highlight-js"><pre><span class="s2">"hashtags"</span><span class="o">:</span> <span class="mi">5</span>
</pre></div>

<p><strong>count</strong> is boolean. If it is true filter will be send count of all tweets with every tweet else it won’t.</p>

<div class="highlight highlight-js"><pre><span class="s2">"count"</span><span class="o">:</span> <span class="kc">true</span>
</pre></div>

<p><strong>storage</strong> specify file where save tweet quantity filtered by your request. It will be used only if <strong>count</strong> is true.</p>

<div class="highlight highlight-js"><pre><span class="s2">"storage"</span><span class="o">:</span> <span class="s2">"count.txt"</span>
</pre></div>

<p><strong>media</strong> specify settings for images in tweets. You can specify width and height of images and class of links images wrapped in.</p>

<div class="highlight highlight-js"><pre><span class="s2">"media"</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">"width"</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
  <span class="s2">"height"</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
  <span class="s2">"class"</span><span class="o">:</span> <span class="s2">"tweet_image"</span>
<span class="p">}</span>
</pre></div>

<h2>
<a name="development" class="anchor" href="#development"><span class="octicon octicon-link"></span></a>Development</h2>

<p>To get the source form Github execute</p>

<div class="highlight highlight-bash"><pre>git clone git@github.com:serenity/twtcst.git
<span class="nb">cd </span>twtcst

npm link
cake build
</pre></div>

<p>Then you should specify your access token in <code>examples/staff/oauth.js</code>. Now you have a working example.</p>

<p>To try <code>twtcst.filter</code> execute</p>

<div class="highlight highlight-bash"><pre>node examples/filter.js
</pre></div>

<p>The script puts new tweet to console.</p>

<p>To try <code>twtcst.search</code> execute</p>

<div class="highlight highlight-bash"><pre>node examples/search.js
</pre></div>

<p>First the scripts puts an array of tweets get from search to console and then it will output tweets from stream.</p>

<p>Finally, you can view the working html page with stream of tweets. Just execute</p>

<div class="highlight highlight-bash"><pre>node examples/socket-server.js
</pre></div>

<p>and open the examples/index.html in your browser.</p>

<hr><h2>
<a name="authors" class="anchor" href="#authors"><span class="octicon octicon-link"></span></a>Authors</h2>

<ul>
<li>
<a href="//github.com/meritt">Alexey Simonenko</a>, <a href="mailto:alexey@simonenko.su">alexey@simonenko.su</a>, <a href="http://simonenko.su">simonenko.su</a>
</li>
<li>
<a href="//github.com/isquariel">Sophia Ilinova</a>, <a href="mailto:tavsophi@gmail.com">tavsophi@gmail.com</a>
</li>
</ul><h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p>The MIT License, see the included <code>License.md</code> file.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-37507032-3");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>